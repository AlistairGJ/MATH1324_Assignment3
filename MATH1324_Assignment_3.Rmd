---
title: "MATH1324 Assignment 3"
subtitle: Supermarket Price Wars
output:
  html_notebook: default
  pdf_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Group/Individual Details

* Alistair Grevis-James (s3644119)

### Executive Statement

In your own words, provide a brief summary of the investigation. Explain the aim of the investigation, the procedure, sample, variables, main findings and conclusions. Write this section last after you have performed hypothesis testing. (Word count Max: 300 words)

### Hypothesis
As both Coles and Woolworths heavily market themselves to be "low cost", over a sample of identical goods (identical being defined as manufactured goods that are stocked at both Coles and Woolworths), they will have the same mean cost.  

The statistical hypotheses for the paired-samples t-test are as follows:  

* H0:μΔ=0
* HA:μΔ≠0

#### Introduction
Coles Supermarkets Australia Pty Ltd (trading as Coles) and Woolworths Supermarkets (colloquially known as "Woolworths" or "Woolies") were founded in Australia in 1914 and 1924, respectively [^1],[^2]. Together, they make up more than 80% of the Australian market. Both Coles and Woolworths market themselves as extremely price competitive, whilst maintaining high quality products and a wide range [^3]. Over the course of this investigation, we will attempt to prove or disprove our null hypothesis (as outlined above).

##### Data Collection
The price comparison website www.frugl.com.au[^4] was used for data collection. Data was collected over three days (7 Sep, 17 Sep & 18 Sep 2017) within the postcode 3054 (Carlton North, Victoria, Australia). Date was noted as sale items will change with time (and thus collection was performed within an 11 day window). Postcode was kept constant as different regions will presumably have specials and full priced products based on geographies (for example shops in Queensland may sell mangos at much cheaper prices than in Victoria). Such assumption could be evaluated, however are outside the scope of this investigation.  

Frugl allows filtering of products into a selection of distinct native categories, for example HEALTH & BEAUTY or BAKING. Categories were chosen based on the likelyhood of containing identical products. For example 'Nivea Moisturiser 200g' is manufactured and thus identical between Coles and Woolworths stores, whereas Coles may stock 'Fresh Celery 250g' while Woolworths may stock 'Farm Fresh Celery 225g'. These subtle differences make comparison harder, and so products like the latter were ignored. For the products sampled, the native categories and their respective item counts will be explored below.  

For each item four prices were recorded; i. Coles Full Price, ii. Coles Sale Price, iii. Woolworths Full Price & iv. Woolworths Sale Price. If the item was not on sale, the full price was simply recorded into both the full price and the sale column. This was done to for ease of data processing, as delta = 0 between the full price and sale column (within either the Coles or Woolworths categories) will indicate the item is not presently on sale.  

Data was collated into a Google Sheet, which was pulled directly into the R Markdown environment. See below for data structure and importation methology.

#### Load Packages and Data
```{r, eval=FALSE}
library(car)
library(ggplot2)
library(dplyr)
library(gsheet)
library(gridExtra)
library("htmltools")
library(reshape2)
ds <- gsheet2tbl('https://drive.google.com/open?id=1_6RZ0HXg7VbgO78oyFfUyZaFOUHYWijy8XH1_jw5tA4')
```
#### Summary Statistics, Data Checking and Initial Visualization
The importation of the data set from Google Sheets as 'ds' was checked with summary, and the attribute names were also checked using sapply. During data collection, identical items available at both Coles and Woolworths were chosen. These items came from the following native categories on the Frugl website - BAKING, DAIRY & EGGS DIETARY, HEALTH & LIFESTYLE, DRINKS, FROZEN FOOD, HEALTH & BEAUTY, PACKAGED & READY MEALS and PANTRY, value counts can be seen below.  

During data collection, these items were re-categorized into the following categories - Beauty, Diet/ Gym Food, Sugary Snack and Supplement, value counts can also be seen below. For this investigation the allocated categories will be used, as they contain the same number of products but spread over fewer groupings. In many cases the allocated categories more accuratly group the products. For example `table(ds$"Allocated Category")` see four items that can be accurately categorized together as sugary snacks.

```{r}
## Summary
summary(ds)
```
```{r}
## Checking the column names and corresponding data types
sapply(ds, typeof)
```
```{r}
## Value counts for the native categories
table(ds$`Native Category`)
```
```{r}
## Value counts for the allocated categories
table(ds$`Allocated Category`)
```
```{r}
## Exploring the Allocated Categories
ds[c(281,286,291,300),c(2,3,4)]
```
```{r}
#Exploring Unit and Amount - Data Selection
ds[c(9,47,17,234,283,409),c(2,4,9,10)]
```
```{r}
#Value Counts for Unit
table(ds$`Unit`)
```
The attributes "Unit" and "Amount" refer to the unit of measurement the product comes in and the amount, respectively (see exploration code blocks below). Value counts were used to check the categorical attribute Unit.  

A scatter plot and a stacked histogram were used explore amount.
```{r}
#Exploring Unit and Amount - Dot Plot
qplot(data=ds, x=Amount, y=ds$`Allocated Category`, colour = ds$`Allocated Category`, main = 'Dot Plot of Allocated Category vs Amount',  ylab = 'Allocated Category', xlab = 'Amount (g, mL, pack)') + theme(legend.title=element_blank())
```
```{r}
#Exploring Unit and Amount - Stacked Histogram
qplot(data=ds, x=Amount, fill = ds$`Allocated Category`, colour = I("Black"), main = 'Stacked Histogram of Allocated Category vs Amount', xlab = 'Amount (g, mL, pack)') + theme(legend.title=element_blank())
```
The exploration up until this point has highlighted numerous challenges working with the data set. The products are distributed between three units, grams (g), milli litres (mL) & pack. Pack has a different meaning in the context of the products. For example `ds[c(9,47,17,234,283,409),c(2,4,9,10)]` shows Tresemme Extra Hold Hair Spray (75g) has units g, with an amount of 75. John Frieda Medium Ash Blonde Hair Colour (1 pack) has the unit pack (not volume or mass) and a quantity of one. In the Supplement category Ostelin Vitamin D & Calcium Tablets (180 pack) has unit pack and quantity 180. The data will be explored further and preprocessed, as described below.

#### Exploring the Native Continuous Data with Scatter Plots
Prior to any transformations, the data was also explored in a qualitative fashion with scatterplots (see below).  
```{r}
wwVcoles <- ggplot(data=ds, aes(x=Coles, y=Woolworths, colour = ds$`Allocated Category`)) +
  stat_smooth(method = "lm", col = "black", size = 0.5) +
  geom_point() + 
  labs(title = 'Woolworths versus Coles Full Price Scatter Plot',  
       y = 'Woolworths Full Price Items (AUD)', 
       x = 'Coles Full Price Items (AUD)') +
  theme(legend.title = element_blank()) +
  annotate("text", x = 15, y = 4, label = "R Squared") + 
  annotate("text", x = 15, y = 1, label = format(summary(lm(Woolworths ~ Coles, data = ds))$r.squared, digits = 3))
wwVcoles
```

```{r}
wwSaleVcolesSale <- ggplot(data=ds, aes(x=ds$'Coles Sale', y=ds$'Woolworths Sale', colour = ds$`Allocated Category`)) +
  stat_smooth(method = "lm", col = "black", size = 0.5) +
  geom_point() + 
  labs(title = 'Woolworths Sale versus Coles Sale Price Scatter Plot',  
       y = 'Woolworths Sale Items (AUD)', 
       x = 'Coles Sale Items (AUD)') +
  theme(legend.title = element_blank()) +
  annotate("text", x = 15, y = 4, label = "R Squared") + 
  annotate("text", x = 15, y = 1, label = format(summary(lm(ds$'Woolworths Sale' ~ ds$'Coles Sale', data = ds))$r.squared, digits = 3))
wwSaleVcolesSale
```
The scatter show (qualitively), that the full price between Woolworhts and Coles is quite well correlated, while the sale price between Woolworths and Coles is poorly correlated by comparison (R squared of 0.988 and 0.735, respectively). This indicates that Coles and Woolworths employ different sale pricing stratergy.

#### Bar Charts of Native Data
These data were plotted into bar charts for Woolworths (denoted WW), Woolworths Sale (denoted WW Sale), Coles and Coles Sale.  

As mentioned prior, these data contain a variety of volumes / units / quantites. The plot below shows the "Beauty" allocated category gives no outliers accrross the four plots, and has well distributed bounds. "Beauty" will be left as is for the subsequent analysis. "Sugary Snack" & "Diet/ Gym Food" will be converted all into price per unit 1000 g. For this exercise we will assume 1 g = 1 mL (a reasonable assumption as any liquids from these categories will be mostly water, and 1 mL water has 1 g of mass). "Supplement" has minimal outliers and well distributed bounds, and will be left as is for the subsequent analysis.
```{r}
colesHist <- ggplot(data=ds, aes(x=ds$'Allocated Category', y=Coles, fill = ds$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "Coles", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,55), expand = c(0, 0))
colesSaleHist <- ggplot(data=ds, aes(x=ds$'Allocated Category', y=ds$`Coles Sale`, fill = ds$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "Coles Sale", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,55), expand = c(0, 0))
wwHist <- ggplot(data=ds, aes(x=ds$'Allocated Category', y=Woolworths, fill = ds$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "WW", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,55), expand = c(0, 0))
wwSaleHist <- ggplot(data=ds, aes(x=ds$'Allocated Category', y=ds$`Woolworths Sale`, fill = ds$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL, x = "WW Sale", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,55), expand = c(0, 0))
```
```{r}
grid.arrange(colesHist, colesSaleHist, wwHist, wwSaleHist, nrow = 4)
```

#### Restructuring the Data
These data were broken into their respective categories.
```{r breaking up categories, echo=TRUE}
beauty_filter <- ds$`Allocated Category` == "Beauty"
beauty_data <- ds[beauty_filter,]
sugarySnack_filter <- ds$`Allocated Category` == "Sugary Snack"
sugarySnack_data <- ds[sugarySnack_filter,]
dietGymFood_filter <- ds$`Allocated Category` == "Diet/ Gym Food"
dietGymFood_data <- ds[dietGymFood_filter,]
supplement_filter <- ds$`Allocated Category` == "Supplement"
supplement_data <- ds[supplement_filter,]
```
Resultant units were breifly checked.
```{r}
#Value Counts for Unit
table(sugarySnack_data$`Unit`)
```
```{r}
#Value Counts for Unit
table(dietGymFood_data$`Unit`)
```
Price per 1000g was generated for "Sugary Snack".
```{r Price per 1000g for Sugary Snack , echo=TRUE}
sugarySnack_data$PriceMass <- 1000 / sugarySnack_data$Amount
sugarySnack_data$Per1000gPrice_Coles <- sugarySnack_data$PriceMass*sugarySnack_data$Coles
sugarySnack_data$Per1000gPrice_WW <- sugarySnack_data$PriceMass*sugarySnack_data$Woolworths
sugarySnack_data$Per1000gPrice_ColesSale <- sugarySnack_data$PriceMass*sugarySnack_data$'Coles Sale'
sugarySnack_data$Per1000gPrice_WWSale <- sugarySnack_data$PriceMass*sugarySnack_data$'Woolworths Sale'
```
Price per 1000g was generated for "Diet/ Gym Food".
```{r Price per 1000g for Diet Gym Food, echo=TRUE}
dietGymFood_data$PriceMass <- 1000 / dietGymFood_data$Amount
dietGymFood_data$Per1000gPrice_Coles <- dietGymFood_data$PriceMass * dietGymFood_data$Coles
dietGymFood_data$Per1000gPrice_WW <- dietGymFood_data$PriceMass * dietGymFood_data$Woolworths
dietGymFood_data$Per1000gPrice_ColesSale <- dietGymFood_data$PriceMass * dietGymFood_data$'Coles Sale'
dietGymFood_data$Per1000gPrice_WWSale <- dietGymFood_data$PriceMass * dietGymFood_data$'Woolworths Sale'
```
These data were exported to .csv and recombined with the Beauty and Supplment data to give dsAdjusted.
```{r}
write.csv(dietGymFood_data, file = "DietGymFood.csv")
write.csv(sugarySnack_data, file = "SugarySnack.csv")
dsAdjusted <- gsheet2tbl('https://docs.google.com/spreadsheets/d/1VQh07x0OQaaADhflcZ5YY17bB0Ho9kUsPycBsRFYsIk/edit?usp=sharing')
```
#### Box Plot of dsAdjusted
```{r}
colesHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=ColesAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "Coles Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,410), expand = c(0, 0))
colesSaleHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=ColesSaleAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "Coles Sale Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,410), expand = c(0, 0))
wwHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=WoolworthsAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "WW Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,410), expand = c(0, 0))
wwSaleHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=WoolworthsSaleAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL, x = "WW Sale Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,410), expand = c(0, 0))
```

```{r}
grid.arrange(colesHistAdjusted, colesSaleHistAdjusted, wwHistAdjusted, wwSaleHistAdjusted, nrow = 4)
```
Outlier identification was then performed.
```{r subsetting for outliers, echo=TRUE}
sugarySnack_filterAdjusted <- dsAdjusted$`Allocated Category` == "Sugary Snack"
sugarySnack_dataAdjusted <- dsAdjusted[sugarySnack_filterAdjusted,]
dietGymFood_filterAdjusted <- dsAdjusted$`Allocated Category` == "Diet/ Gym Food"
dietGymFood_dataAdjusted <- dsAdjusted[dietGymFood_filter,]
```

```{r}
summary(sugarySnack_dataAdjusted$ColesAdjusted)
```
```{r}
dsAdjusted[dsAdjusted$ColesAdjusted == 83.33,]
```
```{r}
sugarySnack_dataAdjusted[sugarySnack_dataAdjusted$WoolworthsSaleAdjusted > 50,]
```
```{r}
sugarySnack_dataAdjusted[sugarySnack_dataAdjusted$WoolworthsSaleAdjusted == 56.00,]
```

```{r}
dsAdjusted[dsAdjusted$ColesAdjusted > 110,]
```
The items above were filled with the mean of each category in their respective columns, and data was imported once more as dsAdjusted (name was kept constant for simplicities sake).
```{r}
dsAdjusted <- gsheet2tbl('https://docs.google.com/spreadsheets/d/1C01FHE6Y0gnkEd-gOvbV57Cmd8BXYs0ch1pGDa9aKKs/edit?usp=sharing')
```
#### Box Plot of dsAdjusted with Outliers removed
```{r}
colesHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=ColesAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "Coles Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,410), expand = c(0, 0))
colesSaleHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=ColesSaleAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "Coles Sale Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,410), expand = c(0, 0))
wwHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=WoolworthsAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "WW Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,410), expand = c(0, 0))
wwSaleHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=WoolworthsSaleAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL, x = "WW Sale Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,410), expand = c(0, 0))
```

```{r}
grid.arrange(colesHistAdjusted, colesSaleHistAdjusted, wwHistAdjusted, wwSaleHistAdjusted, nrow = 4)
```
#### Scaled Box Plot of dsAdjusted with Outliers removed
```{r}
colesHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=ColesAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "Coles Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,130), expand = c(0, 0))
colesSaleHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=ColesSaleAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "Coles Sale Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,130), expand = c(0, 0))
wwHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=WoolworthsAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL,  x = "WW Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,130), expand = c(0, 0))
wwSaleHistAdjusted <- ggplot(data=dsAdjusted, aes(x=dsAdjusted$'Allocated Category', y=WoolworthsSaleAdjusted, fill = dsAdjusted$`Allocated Category`)) + geom_boxplot() + theme(legend.title=element_blank()) + labs(title = NULL, x = "WW Sale Adj.", y = NULL) + guides(fill = FALSE) + coord_flip() + scale_y_continuous(limits = c(0,130), expand = c(0, 0))
```

```{r}
grid.arrange(colesHistAdjusted, colesSaleHistAdjusted, wwHistAdjusted, wwSaleHistAdjusted, nrow = 4)
```


```{r}
colesNativeQQplot_FullPrice <- ggplot(data=ds, aes(sample = Coles, colour = ds$`Allocated Category`)) +
theme(legend.title=element_blank(), 
     legend.background = element_rect(fill="transparent"),
     legend.position = c(.22, .95), 
     legend.justification = c("right", "top")) + 
  stat_qq() + labs(title = "Coles Native Full Price Data QQ Plot")
colesNativeQQplot_FullPrice
```

```{r}
colesAdjustedQQplot_FullPrice <- ggplot(data=dsAdjusted, aes(sample = ColesAdjusted, colour = dsAdjusted$`Allocated Category`)) + theme(legend.title=element_blank(), 
     legend.background = element_rect(fill="transparent"),
     legend.position = c(.22, .95), 
     legend.justification = c("right", "top")) + 
  stat_qq() + labs(title = "Coles Adjusted Full Price Data QQ Plot")
colesAdjustedQQplot_FullPrice
```

```{r}
grid.arrange(colesNativeQQplot_FullPrice, colesAdjustedQQplot_FullPrice, nrow = 2)
```

```{r}
colesNativeQQplot_SalePrice <- ggplot(data=ds, aes(sample = ds$`Coles Sale`, colour = ds$`Allocated Category`)) +
theme(legend.title=element_blank(), 
     legend.background = element_rect(fill="transparent"),
     legend.position = c(.22, .95), 
     legend.justification = c("right", "top")) + 
  stat_qq() + labs(title = "Coles Native Sale Price Data QQ Plot")
colesNativeQQplot_SalePrice
```

```{r}
colesAdjustedQQplot_SalePrice <- ggplot(data=dsAdjusted, aes(sample = ColesAdjusted, colour = dsAdjusted$`Allocated Category`)) + theme(legend.title=element_blank(), 
     legend.background = element_rect(fill="transparent"),
     legend.position = c(.22, .95), 
     legend.justification = c("right", "top")) + 
  stat_qq() + labs(title = "Coles Adjusted Sale Price Data QQ Plot")
colesAdjustedQQplot_SalePrice
```

```{r}
grid.arrange(colesNativeQQplot_SalePrice, colesAdjustedQQplot_SalePrice, nrow = 2)
```


ADD Woolworths QQPlots


## Restructuring the Data
Four new data sets were created, one for each of the 
μ1 - μ2 < d

http://stattrek.com/hypothesis-test/difference-in-means.aspx
https://statistics.laerd.com/statistical-guides/hypothesis-testing-3.php
http://www.sthda.com/english/wiki/ggplot2-qq-plot-quantile-quantile-graph-quick-start-guide-r-software-and-data-visualization#customized-qq-plots
http://homepage.divms.uiowa.edu/~luke/classes/STAT4580/qqpp.html
http://ggplot2.tidyverse.org/reference/
https://www.statsdirect.com/help/basics/p_values.htm

###Say we have 500g for $10, then 1000g would cost $20. To obtain a 1000g normalizing factor, we go (1000(g)/amount(g)), then multiply by price. As above, (1000g/500g)*$10 = $20 per kg 

https://statistics.berkeley.edu/computing/r-t-tests 


```{r}
#Is normalization required?
x = rnorm(dsAdjusted$ColesAdjusted)
y = rnorm(dsAdjusted$ColesSaleAdjusted)
t.test(dsAdjusted$ColesAdjusted,dsAdjusted$ColesSaleAdjusted, paired = TRUE)
```


```{r}
#Is normalization required?
x = rnorm(dsAdjusted$ColesAdjusted)
y = rnorm(dsAdjusted$ColesSaleAdjusted)
t.test(dsAdjusted$ColesAdjusted,dsAdjusted$ColesSaleAdjusted, var.equal=TRUE)
```

## Hypothesis Test
We will conduct multiple two-sample t-tests (difference between two means) to evaluate our null hypothesis. This is appropriate as the samples were generated by simple random sampling, the samples are independent, 

The sampling method for each sample is simple random sampling.
The samples are independent.
Each population is at least 20 times larger than its respective sample.
The sampling distribution is approximately normal, which is generally the case if any of the following conditions apply.

The population distribution is normal.
The population data are symmetric, unimodal, without outliers, and the sample size is 15 or less.
The population data are slightly skewed, unimodal, without outliers, and the sample size is 16 to 40.
The sample size is greater than 40, without outliers.
This approach consists of four steps: (1) state the hypotheses, (2) formulate an analysis plan, (3) analyze sample data, and (4) interpret results.



#### TEST


Use R to perform an appropriate hypothesis test to determine which supermarket is the cheapest. You need to explain your choice of hypothesis test, any assumptions and the significance level. 

```{r}
# This is a chunk for your hypothesis testing code.
```

## Interpretation

Interpret the results of the hypothesis test by interpreting the $p$-value and confidence intervals and commenting on the statistical significance of the findings. 

## Discussion 

Discuss the findings of your investigation. What did you conclude? What were the strengths and limitations of your investigation? What improvements could be made or what would you do differently next time?

[^1]: http://www.wesfarmers.com.au/util/news-media/article/2017/06/22/coles-creates-115-jobs-at-its-milestone-800th-supermarket
[^2]: http://www.smh.com.au/business/supermarket-duopoly-blamed-for-soaring-food-prices-20091108-i3tn.html
[^3]: http://www.smh.com.au/business/retail/coles-deepens-price-war-after-slicing-bread-prices-20170712-gxa33p.html
[^4]: https://www.frugl.com.au/ 

http://ggplot2.tidyverse.org/reference/theme.html
http://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html
https://stackoverflow.com/questions/35108443/ggplot2-make-legend-key-fill-transparent
https://stackoverflow.com/questions/16251966/controlling-the-alpha-level-in-a-ggplot2-legend



