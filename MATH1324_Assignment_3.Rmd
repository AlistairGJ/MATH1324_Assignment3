---
title: "MATH1324 Assignment 3"
subtitle: "Supermarket Price Wars"
output: html_notebook
---

## Group/Individual Details

* Alistair Grevis-James (s3644119)

## Executive Statement

In your own words, provide a brief summary of the investigation. Explain the aim of the investigation, the procedure, sample, variables, main findings and conclusions. Write this section last after you have performed hypothesis testing. (Word count Max: 300 words)

#Introduction

Coles Supermarkets Australia Pty Ltd (trading as Coles) and Woolworths Supermarkets (colloquially known as "Woolies") were founded in Australia in 1914 and 1924, respectively ("Coles creates 115 jobs at its milestone 800th supermarket". www.wesfarmers.com.au. Retrieved 2017-07-02., Zappone, Chris (9 November 2009). "Supermarket duopoly blamed for soaring food prices". The Sydney Morning Herald. Retrieved 29 July 2013). Together, they make up more than 80% of the Australian market. Both Coles and Woolworths market themselves as extremely price competitive, whilst maintaining high quality products and a wide range (http://www.smh.com.au/business/retail/coles-deepens-price-war-after-slicing-bread-prices-20170712-gxa33p.html).

Hypothesis A:
While both claiming to be "low cost" blah blah, invariably, one supermarket chain will have lower prices.

Hypothesis B:
In an attempt to differentiate themselves from each other as 'low price' (while still maintaining high quality & a wide range), the two major Australian supermarket chains, Coles and Woolworths, will employ different pricing stratergies to show consumers they have the 'lowest prices'.

```{r}
embed_url("https://www.youtube.com/watch?v=lVSEDRBEbA0&list=PLZ-CbFpL2a-suAVgZ0KKdQzHEZ9KVHKSo&index=6") %>%
  div(class = "vembedr") %>%
  div(align = "center")
```

Embed coles in also
https://mumbrella.com.au/woolworths-increases-focus-cheap-prices-latest-ad-targeting-families-433968 reference!!!

#Data Collection Methodology

#Install Packages
```{r}
install.packages('gsheet')
install.packages("vembedr")
install.packages("gridExtra")
```

## Load Packages and Data
```{r}
library(ggplot2)
library(dplyr)
library(gsheet)
library(vembedr)
library(gridExtra)
library("htmltools")
ds <- gsheet2tbl('https://drive.google.com/open?id=1_6RZ0HXg7VbgO78oyFfUyZaFOUHYWijy8XH1_jw5tA4')
# This is a chunk where you can load the necessary data and packages required to reproduce the report
# You should also include your code required to prepare your data for analysis.
```

## Summary Statistics

## Data Checking
The internal structure of the data was first checked with str(). This showed the data was in the form 'data.frame' with 491 observations of 10 variables. Data types consisted of Date, chr, num and int. CB!!!
```{r}
#Column check & data types
sapply(ds, typeof)
#sapply gives us the column (variable) names & the data types
#Data tabulated was considered simply as good practise
```

```{r}
#Check for nulls WRONG!!!
ds[rowSums(is.na(ds))==TRUE,]
#Summary ds will give NAs + preliminary data analysis
summary(ds)
```

```{r}
#Value Counts - checking CHARACTERS
table(ds$`Allocated Category`)
```

```{r}
#Value Counts - checking CHARACTERS
table(ds$`Native Category`)
```
###Coles, coles sale, woolworths, woolworths sale are the prices - at this stage we are checking characters only
```{r}
#Value Counts - checking CHARACTERS
table(ds$`Unit`)
```
###We are now going to veiw native histograms for ALLOCATED CATEGORIES
###Ignore meat & fish
```{r}
#Coles (full price), for sugary snack
mean_coles_sugarySnack <- mean(ds$coles, select(ds$`Allocated Category` = 'Sugary Snack'))
ds$Coles == 'Sugary Snack'

summary(ds)
```



```{r}
#Value Counts
sapply(ds, typeof)
```
Walk through the data...

Use R to summarise the data from the investigation. 

Include an appropriate plot to help visualise the data. Describe the trend. 

```{r}
# This is a chunk for your summary statistics and visualisation code
ds$Coles
```

```{r}
#Creating new data set for allocated category sugary snack data
#Creating a filter
sugarySnack_filter <- ds$`Allocated Category` == "Sugary Snack"
#Creating the data set
sugarySnack_data <- ds[sugarySnack_filter,]
#In this instance we will take grams and mL to be equal (as at SLP, 1 mL has a mass of 1 g)

#Check units
table(sugarySnack_data$`Unit`)

sugarySnack_data$PriceMass <- 1000 / sugarySnack_data$Amount
sugarySnack_data$Per1000gPrice_Coles <- sugarySnack_data$PriceMass * sugarySnack_data$Coles
sugarySnack_data$Per1000gPrice_WW <- sugarySnack_data$PriceMass * sugarySnack_data$Woolworths
sugarySnack_data$Per1000gPrice_ColesSale <- sugarySnack_data$PriceMass * sugarySnack_data$'Coles Sale'
sugarySnack_data$Per1000gPrice_WWSale <- sugarySnack_data$PriceMass * sugarySnack_data$'Woolworths Sale'
#Stats - Native

mean_sugarySnack_coles <- mean(sugarySnack_data$Coles)
sd_sugarySnack_coles <- sd(sugarySnack_data$Coles)
hist(sugarySnack_data$Coles, xlim = c(0,20), ylim = c(0, 0.35), col="grey", xlab="Price AUD (variable amount g or mL)",main="Histogram of Sugary Snacks at Coles (full price)", breaks = 11, freq = FALSE)
curve(expr = dnorm(x, mean=mean_sugarySnack_coles, sd = sd_sugarySnack_coles), col="darkblue", lwd=2,   add=TRUE)

mean_sugarySnack_colesSale <- mean(sugarySnack_data$'Coles Sale')
sd_sugarySnack_colesSale <- sd(sugarySnack_data$'Coles Sale')
hist(sugarySnack_data$'Coles Sale', xlim = c(0,10), ylim = c(0, 0.5), col="grey", xlab="Price AUD (variable amount g or mL)", main="Histogram of Sugary Snacks at Coles (sale price)", freq = FALSE)
curve(expr = dnorm(x, mean=mean_sugarySnack_colesSale, sd = sd_sugarySnack_colesSale), col="darkblue", lwd=2, add=TRUE)

mean_Per1000gPrice_Coles <- mean(sugarySnack_data$Per1000gPrice_Coles)
sd_Per1000gPrice_Coles <- sd(sugarySnack_data$Per1000gPrice_Coles)
hist(sugarySnack_data$Per1000gPrice_Coles, xlim = c(-10,100), ylim = c(0, 0.04), col="grey", xlab="Price (per 1000 g or mL)", main="Histogram of Sugary Snacks at Coles (full price)", freq = FALSE)
curve(expr = dnorm(x, mean=mean_Per1000gPrice_Coles, sd = sd_Per1000gPrice_Coles), col="darkblue", lwd=2, add=TRUE)

mean_Per1000gPrice_ColesSale <- mean(sugarySnack_data$Per1000gPrice_ColesSale)
sd_Per1000gPrice_ColesSale <- sd(sugarySnack_data$Per1000gPrice_ColesSale)
hist(sugarySnack_data$Per1000gPrice_ColesSale, xlim = c(-10,100), ylim = c(0, 0.05), col="grey", xlab="Price (per 1000 g or mL)", main="Histogram of Sugary Snacks at Coles (sale price)", freq = FALSE)
curve(expr = dnorm(x, mean=mean_Per1000gPrice_ColesSale, sd = sd_Per1000gPrice_ColesSale), col="darkblue", lwd=2, add=TRUE)

mean_sugarySnack_Woolworths <- mean(sugarySnack_data$Woolworths)
sd_sugarySnack_Woolworths <- sd(sugarySnack_data$Woolworths)
hist(sugarySnack_data$Woolworths, xlim = c(0,20), ylim = c(0, 0.35), col="grey", xlab="Price AUD (variable amount g or mL)",main="Histogram of Sugary Snacks at WW (full price)", breaks = 11, freq = FALSE)
curve(expr = dnorm(x, mean=mean_sugarySnack_Woolworths, sd = sd_sugarySnack_Woolworths), col="darkblue", lwd=2,   add=TRUE)

mean_sugarySnack_WoolworthsSale <- mean(sugarySnack_data$'Woolworths Sale')
sd_sugarySnack_WoolworthsSale <- sd(sugarySnack_data$'Coles Sale')
hist(sugarySnack_data$'Coles Sale', xlim = c(0,10), ylim = c(0, 0.5), col="grey", xlab="Price AUD (variable amount g or mL)", main="Histogram of Sugary Snacks at Coles (sale price)", freq = FALSE)
curve(expr = dnorm(x, mean=mean_sugarySnack_colesSale, sd = sd_sugarySnack_colesSale), col="darkblue", lwd=2, add=TRUE)

mean_Per1000gPrice_Coles <- mean(sugarySnack_data$Per1000gPrice_Coles)
sd_Per1000gPrice_Coles <- sd(sugarySnack_data$Per1000gPrice_Coles)
hist(sugarySnack_data$Per1000gPrice_Coles, xlim = c(-10,100), ylim = c(0, 0.04), col="grey", xlab="Price (per 1000 g or mL)", main="Histogram of Sugary Snacks at Coles (full price)", freq = FALSE)
curve(expr = dnorm(x, mean=mean_Per1000gPrice_Coles, sd = sd_Per1000gPrice_Coles), col="darkblue", lwd=2, add=TRUE)

mean_Per1000gPrice_ColesSale <- mean(sugarySnack_data$Per1000gPrice_ColesSale)
sd_Per1000gPrice_ColesSale <- sd(sugarySnack_data$Per1000gPrice_ColesSale)
hist(sugarySnack_data$Per1000gPrice_ColesSale, xlim = c(-10,100), ylim = c(0, 0.05), col="grey", xlab="Price (per 1000 g or mL)", main="Histogram of Sugary Snacks at Coles (full price)", freq = FALSE)
curve(expr = dnorm(x, mean=mean_Per1000gPrice_Coles, sd = sd_Per1000gPrice_Coles), col="darkblue", lwd=2, add=TRUE)

#Come back to summary stats table
summary(sugarySnack_data$Coles)
summary(sugarySnack_data$'Coles Sale')

s <- ggplot(data=sugarySnack_data, aes(x=Coles))
s + geom_histogram()

s3 <- ggplot(data=ds, aes(x=Coles))
s3 + geom_histogram(aes(fill=ds$`Allocated Category`), colour="Black")

s4 <- ggplot(data=ds, aes(x=Woolworths))
s4 + geom_histogram(aes(fill=ds$`Allocated Category`), colour="Black")




```

```{r pressure, echo=FALSE}
s3 <- ggplot(data=ds, aes(x=Coles))
s3 + geom_histogram(aes(fill=ds$`Allocated Category`), colour="Black")
```


###Say we have 500g for $10, then 1000g would cost $20. To obtain a 1000g normalizing factor, we go (1000(g)/amount(g)), then multiply by price. As above, (1000g/500g)*$10 = $20 per kg 

```{r}
#Creating new data set for allocated category Diet/ Gym Food
#Creating a filter
dietGymFood_filter <- ds$`Allocated Category` == "Diet/ Gym Food"
#Creating the data set
dietGymFood_data <- ds[dietGymFood_filter,]
#Check units
table(dietGymFood_data$`Unit`)
#In this instance we will take grams and mL to be equal (as at SLP, 1 mL has a mass of 1 g)
sugarySnack_data$PriceMass <- 1000 / sugarySnack_data$Amount
sugarySnack_data$Per1000gPrice_Coles <- sugarySnack_data$PriceMass * sugarySnack_data$Coles
#Creating the Coles Sale sugary snack column
sugarySnack_data$Per1000gPrice_ColesSale <- sugarySnack_data$PriceMass * sugarySnack_data$'Coles Sale'
#Stats - Native

mean_sugarySnack_coles <- mean(sugarySnack_data$Coles)
sd_sugarySnack_coles <- sd(sugarySnack_data$Coles)
hist(sugarySnack_data$Coles, xlim = c(0,20), ylim = c(0, 0.35), col="grey", xlab="Price AUD (variable amount g or mL)",main="Histogram of Sugary Snacks at Coles (full price)", breaks = 11, freq = FALSE)
curve(expr = dnorm(x, mean=mean_sugarySnack_coles, sd = sd_sugarySnack_coles), col="darkblue", lwd=2,   add=TRUE)

mean_sugarySnack_colesSale <- mean(sugarySnack_data$'Coles Sale')
sd_sugarySnack_colesSale <- sd(sugarySnack_data$'Coles Sale')
hist(sugarySnack_data$'Coles Sale', xlim = c(0,10), ylim = c(0, 0.5), col="grey", xlab="Price AUD (variable amount g or mL)", main="Histogram of Sugary Snacks at Coles (sale price)", freq = FALSE)
curve(expr = dnorm(x, mean=mean_sugarySnack_colesSale, sd = sd_sugarySnack_colesSale), col="darkblue", lwd=2, add=TRUE)

mean_Per1000gPrice_Coles <- mean(sugarySnack_data$Per1000gPrice_Coles)
sd_Per1000gPrice_Coles <- sd(sugarySnack_data$Per1000gPrice_Coles)
hist(sugarySnack_data$Per1000gPrice_Coles, xlim = c(-10,100), ylim = c(0, 0.04), col="grey", xlab="Price (per 1000 g or mL)", main="Histogram of Sugary Snacks at Coles (full price)", freq = FALSE)
curve(expr = dnorm(x, mean=mean_Per1000gPrice_Coles, sd = sd_Per1000gPrice_Coles), col="darkblue", lwd=2, add=TRUE)

mean_Per1000gPrice_ColesSale <- mean(sugarySnack_data$Per1000gPrice_ColesSale)
sd_Per1000gPrice_ColesSale <- sd(sugarySnack_data$Per1000gPrice_ColesSale)
hist(sugarySnack_data$Per1000gPrice_ColesSale, xlim = c(-10,100), ylim = c(0, 0.05), col="grey", xlab="Price (per 1000 g or mL)", main="Histogram of Sugary Snacks at Coles (full price)", freq = FALSE)
curve(expr = dnorm(x, mean=mean_Per1000gPrice_Coles, sd = sd_Per1000gPrice_Coles), col="darkblue", lwd=2, add=TRUE)

#Come back to summary stats table
summary(sugarySnack_data$Coles)
summary(sugarySnack_data$'Coles Sale') 
```

```{r}

```

```{r}

```


## Hypothesis Test

Use R to perform an appropriate hypothesis test to determine which supermarket is the cheapest. You need to explain your choice of hypothesis test, any assumptions and the significance level. 

```{r}
# This is a chunk for your hypothesis testing code.
```

## Interpretation

Interpret the results of the hypothesis test by interpreting the $p$-value and confidence intervals and commenting on the statistical significance of the findings. 

## Discussion 

Discuss the findings of your investigation. What did you conclude? What were the strengths and limitations of your investigation? What improvements could be made or what would you do differently next time?


